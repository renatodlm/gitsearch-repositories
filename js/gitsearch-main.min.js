var current_url=location.protocol+"//"+location.host+location.pathname,httpheader={Authorization:"Bearer "+gitsearch_script_params.gitsearchtoken};document.addEventListener("DOMContentLoaded",function(e){"use strict";function t(e,t,r){return e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,function(){r.call(e)}),!1}function r(){return JSON.parse(localStorage.getItem("favorites"))}function n(e){return localStorage.setItem("favorites",JSON.stringify(e)),!1}function i(e,t){var i=r()||{},s=(this.parentNode.parentNode,this.getAttribute("data-repository-id")),l=this.getAttribute("data-repository-name"),u=document.getElementById("gitsearch-favorites-content"),g=this.getAttribute("data-repository-url");i[s]=[l,g],n(i),(m=document.getElementById("gitsearch-alert"))&&m.remove();var d='<span id="gitsearch-alert">Reposit√≥rio '+l+" adicionado aos favoritos</span>";document.getElementById("gitsearch-favorites").insertAdjacentHTML("beforeend",d);var m=document.getElementById("gitsearch-alert");return setTimeout(function(){m.style.bottom="30px",setTimeout(function(){m.style.opacity="0",setTimeout(function(){m.remove()},1e3)},5e3)},30),setTimeout(o(),10),a(u),c(),!1}function s(e,t){var i=r(),s=(e.parentNode.parentNode,document.getElementById("gitsearch-favorites-content")),l=e.getAttribute("data-repository-id");if(null!=i&&i.hasOwnProperty(l)&&delete i[l],0==function(e){var t=0;for(var r in e)t++;return t}(i)){localStorage.removeItem("favorites");for(var u=document.getElementsByClassName("gitsearch-favorite-item"),g=0;g<u.length;g++){(d=u[g]).querySelectorAll(".gitsearch-favorite-selected")[0].classList.remove("selected"),d.querySelectorAll(".gitsearch-favorite-unselected")[0].classList.add("selected")}}else n(i);for(u=document.getElementsByClassName("gitsearch-favorite-item"),g=0;g<u.length;g++){var d=u[g];for(var m in i)d.getAttribute("data-repository-id")!=m&&(d.querySelectorAll(".gitsearch-favorite-selected")[0].classList.remove("selected"),d.querySelectorAll(".gitsearch-favorite-unselected")[0].classList.add("selected"))}return setTimeout(o(),10),a(s),c(),!1}function o(e){var t=r(),n=0,i=document.getElementById("favoritesCounter");if(null!==t)for(var s in t)for(var o=0;o<t[s].length;o++)1==o&&(n+=1);return c(),i.innerHTML=n}function a(e){var t=r(),n="",i=e,s=document.getElementsByClassName("gitsearch-favorite-item");if(i.innerHTML="",null!==t){for(var o in t)n+='<li class="item-id-'+o+'"><a href="'+t[o][1]+'"><h4>'+t[o][0]+'</h4></a><button class="gitsearch-btn-remove" data-repository-id="'+o+'">X</button></li>';for(var a=0;a<s.length;a++){var l=s[a];for(var o in t)l.getAttribute("data-repository-id")==o&&(l.querySelectorAll(".gitsearch-favorite-unselected")[0].classList.remove("selected"),l.querySelectorAll(".gitsearch-favorite-selected")[0].classList.add("selected"))}i.innerHTML=n}else{for(a=0;a<s.length;a++){(l=s[a]).querySelectorAll(".gitsearch-favorite-selected")[0].classList.remove("selected"),l.querySelectorAll(".gitsearch-favorite-unselected")[0].classList.add("selected")}i.innerHTML='<div class="alert alert-warning">nenhum favorito.</div>'}return c(),!1}function c(){for(var e=document.getElementsByClassName("gitsearch-btn-remove"),r=0;r<e.length;++r){t(e[r],"click",function(e){s(this)})}}var l=document.getElementById("gitsearch-repositories");function u(){l.value&&""!=l.value?fetch("https://api.github.com/search/repositories?q="+l.value+"&per_page=5&page=1",{method:"GET",headers:httpheader}).then(function(e){return e.json()}).then(function(e){var t="";e.items.forEach(e=>{t+='<li><a href="'+current_url+"?gitSearchOwner="+e.owner.login+"&gitSearchRepo="+e.name+'"><h4>'+e.full_name+'</h4><p class="gitsearch-description">'+e.description+"</p></a></li>"}),t+='<li class="gitsearch-li-viewmore"><input id="gitsearch-viewmore" type="submit" value="ver mais..."></li>',document.getElementById("gitsearch-suggestions").style.height="auto",document.getElementById("gitsearch-suggestions").style.padding="15px",document.getElementById("gitsearch-suggestions").style.opacity="1",document.getElementById("gitsearch-suggestions").innerHTML=t}).catch(e=>{console.error(e),document.getElementById("gitsearch-suggestions").style.height="0",document.getElementById("gitsearch-suggestions").style.padding="0px",document.getElementById("gitsearch-suggestions").style.opacity="0",document.getElementById("gitsearch-suggestions").innerHTML=""}):(document.getElementById("gitsearch-suggestions").style.height="0",document.getElementById("gitsearch-suggestions").style.padding="0px",document.getElementById("gitsearch-suggestions").style.opacity="0",document.getElementById("gitsearch-suggestions").innerHTML="",document.getElementById("gitsearch-suggestions").innerHTML="")}l.onchange=u,l.onkeyup=u,l.onfocusout=u,addEventListener("keyup",function(e){!function(e){if(e.preventDefault(),"Escape"!==e.key&&"Esc"!==e.key)return!1;u()}(e)});var g=document.querySelectorAll(".gitsearch-repos-item"),d=document.getElementById("gitsearch-favorites-content"),m=document.getElementById("gitsearch-favorite-current-repo"),h=document.getElementById("clear_favorites"),f=document.getElementById("openfavorites");m&&t(m,"click",function(){t(m,"click",i)});for(var v=0;v<g.length;v++)t(g[v].querySelector(".gitsearch-favorite-item"),"click",i);o(),d&&a(d),f&&t(f,"click",function(){a(d)}),h&&t(h,"click",function(e){localStorage.removeItem("favorites"),setTimeout(o(),10),a(d)}),c()});